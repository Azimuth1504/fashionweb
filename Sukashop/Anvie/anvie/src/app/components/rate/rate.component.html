<ng-template #content let-c="close" let-d="dismiss">
    <div class="modal-header" style="background: linear-gradient(135deg, #f6d365 0%, #fda085 100%); color: #333;">
        <h5 class="modal-title m-0"><i class="fa fa-star mr-2"></i>Đánh giá sản phẩm</h5>
        <button type="button" class="close" (click)="d('Cross click')"><span>&times;</span></button>
    </div>
    <div class="modal-body" style="background: #fafafa;">
        <form [formGroup]="postForm">
            <input type="hidden" formControlName="id">
            <input type="hidden" formControlName="product">
            <input type="hidden" formControlName="rating">

            <!-- Product Info -->
            <div class="d-flex align-items-center p-3 mb-3"
                style="background: white; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                <img [src]="orderDetail.product?.image || orderDetail.productImage"
                    style="width: 80px; height: 80px; object-fit: cover; border-radius: 8px;">
                <div class="ml-3">
                    <h6 style="margin: 0; font-weight: 600;">{{orderDetail.product?.name || orderDetail.productName}}</h6>
                    <p style="margin: 5px 0 0 0; color: #888; font-size: 13px;">
                        <i class="fa fa-shopping-bag mr-1"></i>Số lượng: {{orderDetail.quantity}}
                    </p>
                </div>
            </div>

            <!-- Rating Stars -->
            <div class="p-3 mb-3" style="background: white; border-radius: 8px; text-align: center;">
                <label style="display: block; font-weight: 600; margin-bottom: 10px;">Chất lượng sản phẩm</label>
                <ngb-rating class="rating-stars" [(rate)]="star" [(ngModel)]="star"
                    [ngModelOptions]="{standalone: true}" [starTemplate]="t" [readonly]="false" [max]="5"></ngb-rating>
                <p style="margin: 10px 0 0 0; color: #f6d365; font-weight: 500;">
                    {{ star === 5 ? 'Tuyệt vời' : star === 4 ? 'Hài lòng' : star === 3 ? 'Bình thường' : star === 2 ?
                    'Không hài lòng' : 'Rất tệ' }}
                </p>
            </div>

            <!-- Comment -->
            <div class="p-3" style="background: white; border-radius: 8px;">
                <label style="font-weight: 600; margin-bottom: 10px; display: block;">
                    <i class="fa fa-comment-o mr-1"></i>Nhận xét của bạn
                </label>
                <textarea class="form-control" formControlName="comment" rows="4"
                    placeholder="Hãy chia sẻ những điều bạn thích về sản phẩm này..."
                    style="border-radius: 8px; resize: none;"></textarea>
            </div>
        </form>
    </div>
    <div class="modal-footer" style="background: #fafafa; border-top: none;">
        <button type="button" class="btn btn-outline-secondary" (click)="d('Cancel')">
            <i class="fa fa-times mr-1"></i>Hủy
        </button>
        <button type="button" class="btn"
            style="background: linear-gradient(135deg, #f6d365 0%, #fda085 100%); color: #333; border: none;"
            (click)="rating()"
            [disabled]="!orderDetail.product">
            <i class="fa fa-paper-plane mr-1"></i>Gửi đánh giá
        </button>
    </div>
</ng-template>

<a class="rate-icon" (click)="open(content)" title="Đánh giá sản phẩm">
    <i class="fa fa-star"></i>
</a>

<!-- star template -->
<ng-template #t let-fill="fill">
    <span class="star" [class.full]="fill === 100" style="font-size: 28px; cursor: pointer;">
        <span class="half" [style.width.%]="fill">
            <i class="fa fa-star" style="color: #ffc107;"></i>
        </span>
        <i class="fa fa-star" style="color: #ddd;"></i>
    </span>
</ng-template>
